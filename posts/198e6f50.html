<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Oracle12c与Oracle11g采用触发器与存储过程实现同步更新（代码+图解） | BitHachi</title><meta name="description" content="Oracle12c与Oracle11g采用触发器与存储过程实现同步更新"><meta name="keywords" content="Oracle,Database,trigger,procedure"><meta name="author" content="BitHachi"><meta name="copyright" content="BitHachi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.bithachi.cn/posts/198e6f50.html"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//ta.qq.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="baidu-site-verification" content="3VJlgEduPjcVcUAR"/><meta property="og:type" content="article"><meta property="og:title" content="Oracle12c与Oracle11g采用触发器与存储过程实现同步更新（代码+图解）"><meta property="og:url" content="https://www.bithachi.cn/posts/198e6f50.html"><meta property="og:site_name" content="BitHachi"><meta property="og:description" content="Oracle12c与Oracle11g采用触发器与存储过程实现同步更新"><meta property="og:image" content="https://cdn.pixabay.com/photo/2017/09/26/02/41/swim-2787543_1280.jpg"><meta property="article:published_time" content="2020-10-23T02:10:12.000Z"><meta property="article:modified_time" content="2020-10-23T08:16:03.109Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = '2'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="Servlet入门篇" href="https://www.bithachi.cn/posts/cc4f65f8.html"><link rel="next" title="前后台json交互，以及数据库json转换——PHP&amp;Thinkphp5.1" href="https://www.bithachi.cn/posts/50fa6455.html"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8f5f31c25712dd1fb6414ae53fd6ecaf";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-171838759-1', 'auto');
ga('send', 'pageview');
</script><script src="https://tajs.qq.com/stats?sId=66572961" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: BitHachi","link":"链接: ","source":"来源: BitHachi","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="baidu-site-verification" content="V1TxT1VCnF" /><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/bithachi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">47</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">88</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">14</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books"><i class="fa-fw fa fa-bookmark"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/MessageBoard/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、保证两台笔记本网络互通"><span class="toc-text">一、保证两台笔记本网络互通</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、用户简单架构图及权限设计"><span class="toc-text">二、用户简单架构图及权限设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、表结构"><span class="toc-text">三、表结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、sys授予系统权限，创建DBA账户"><span class="toc-text">四、sys授予系统权限，创建DBA账户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、双方各自创建的DBA账户再创建其他用户，以及私有同义词"><span class="toc-text">五、双方各自创建的DBA账户再创建其他用户，以及私有同义词</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、创建同步触发器与存储过程"><span class="toc-text">六、创建同步触发器与存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-触发器"><span class="toc-text">6.1 触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2存储过程"><span class="toc-text">6.2存储过程</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.pixabay.com/photo/2017/09/26/02/41/swim-2787543_1280.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">BitHachi</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books"><i class="fa-fw fa fa-bookmark"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/MessageBoard/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Oracle12c与Oracle11g采用触发器与存储过程实现同步更新（代码+图解）</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-10-23 10:10:12 10:10:12"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-10-23 10:10:12</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-10-23 16:16:03 16:16:03"><i class="fas fa-history fa-fw"></i> 更新于 2020-10-23 16:16:03</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Oracle/">Oracle</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">3.2k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 15 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="far fa-comments fa-fw post-meta__icon"></i><span>评论数:</span><a href="/posts/198e6f50.html#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/posts/198e6f50.html" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="一、保证两台笔记本网络互通"><a href="#一、保证两台笔记本网络互通" class="headerlink" title="一、保证两台笔记本网络互通"></a>一、保证两台笔记本网络互通</h2><p>关于连接，详情见之前写的：<a href="https://blog.csdn.net/weixin_43914604/article/details/109089438" target="_blank" rel="noopener">WIFI网络，两台笔记本互联Oracle，一台是11g,一台是12c</a></p>
<p>现在测试的ip地址：</p>
<ul>
<li>A: 10.65.252.84</li>
<li>B: 10.82.156.248</li>
</ul>
<h2 id="二、用户简单架构图及权限设计"><a href="#二、用户简单架构图及权限设计" class="headerlink" title="二、用户简单架构图及权限设计"></a>二、用户简单架构图及权限设计</h2><ul>
<li>A机的DBA账户是shj_dba，B机的DBA账户是c##hachi</li>
<li>中间的为连接名，标明连接的名字，对应权限的用户使用对方跟自己权限相同的账号，通过连接名访问对方数据库。</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023004617.png" alt="image-20201023004617075"></p>
<ul>
<li>各个用户的权限</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023021653.png" alt="image-20201023021653854"></p>
<h2 id="三、表结构"><a href="#三、表结构" class="headerlink" title="三、表结构"></a>三、表结构</h2><ul>
<li>这里双方都采用以下语句创建表，表就建立在各自sys创建的DBA的模式下，不建立任何外键和索引，以免发生同步触发器更新异常，初学先入个门吧！</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023011006.png" alt="image-20201023011006150"></p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023011048.png" alt="image-20201023011048816"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "part"                                                */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"part"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"p_id"</span>               <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"p_name"</span>             <span class="built_in">VARCHAR2</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"p_size"</span>             <span class="built_in">VARCHAR2</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"p_price"</span>            <span class="built_in">FLOAT</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"p_desc"</span>             <span class="built_in">VARCHAR2</span>(<span class="number">50</span>),</span><br><span class="line">   <span class="keyword">constraint</span> PK_PART primary <span class="keyword">key</span> (<span class="string">"p_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "project"                                             */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"project"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"pj_id"</span>              <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"pj_money"</span>           <span class="built_in">FLOAT</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"pj_date"</span>            <span class="built_in">DATE</span>,</span><br><span class="line">   <span class="keyword">constraint</span> PK_PROJECT primary <span class="keyword">key</span> (<span class="string">"pj_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "staff"                                               */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"staff"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"sf_id"</span>              <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"s_id"</span>               <span class="built_in">INTEGER</span>,</span><br><span class="line">   <span class="string">"sta_sf_id"</span>          <span class="built_in">INTEGER</span>,</span><br><span class="line">   <span class="string">"sf_name"</span>            <span class="built_in">VARCHAR2</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"sf_age"</span>             <span class="built_in">SMALLINT</span>,</span><br><span class="line">   <span class="string">"sf_xname"</span>           <span class="built_in">VARCHAR2</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="keyword">constraint</span> PK_STAFF primary <span class="keyword">key</span> (<span class="string">"sf_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "storage"                                             */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"storage"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"s_id"</span>               <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"s_area"</span>             <span class="built_in">FLOAT</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"s_phone"</span>            <span class="built_in">VARCHAR2</span>(<span class="number">11</span>),</span><br><span class="line">   <span class="keyword">constraint</span> PK_STORAGE primary <span class="keyword">key</span> (<span class="string">"s_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "storage_info"                                        */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"storage_info"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"s_id"</span>               <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"p_id"</span>               <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"sf_num"</span>             <span class="built_in">INTEGER</span>,</span><br><span class="line">   <span class="keyword">constraint</span> PK_STORAGE_INFO primary <span class="keyword">key</span> (<span class="string">"s_id"</span>, <span class="string">"p_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "supplier"                                            */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"supplier"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"sp_id"</span>              <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"sp_name"</span>            <span class="built_in">VARCHAR2</span>(<span class="number">10</span>),</span><br><span class="line">   <span class="string">"sp_address"</span>         <span class="built_in">VARCHAR2</span>(<span class="number">30</span>),</span><br><span class="line">   <span class="string">"sp_phone"</span>           <span class="built_in">VARCHAR2</span>(<span class="number">11</span>),</span><br><span class="line">   <span class="string">"sp_acount"</span>          <span class="built_in">VARCHAR2</span>(<span class="number">15</span>),</span><br><span class="line">   <span class="keyword">constraint</span> PK_SUPPLIER primary <span class="keyword">key</span> (<span class="string">"sp_id"</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="comment">/* Table: "supply_info"                                         */</span></span><br><span class="line"><span class="comment">/*==============================================================*/</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">"supply_info"</span> </span><br><span class="line">(</span><br><span class="line">   <span class="string">"p_id"</span>               <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"pj_id"</span>              <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"sp_id"</span>              <span class="built_in">INTEGER</span>              <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">   <span class="string">"sp_num"</span>             <span class="built_in">INTEGER</span>,</span><br><span class="line">   <span class="keyword">constraint</span> PK_SUPPLY_INFO primary <span class="keyword">key</span> (<span class="string">"p_id"</span>, <span class="string">"pj_id"</span>, <span class="string">"sp_id"</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h2 id="四、sys授予系统权限，创建DBA账户"><a href="#四、sys授予系统权限，创建DBA账户" class="headerlink" title="四、sys授予系统权限，创建DBA账户"></a>四、sys授予系统权限，创建DBA账户</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--------------------------   一些可能用得上的查询调试语句   ------------------------------------------ </span></span><br><span class="line"><span class="comment">-- 命令行查看是否有远程连接权限</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> user_sys_privs <span class="keyword">where</span> privilege <span class="keyword">like</span> <span class="keyword">upper</span>(<span class="string">'%DATABASE LINK%'</span>); </span><br><span class="line"><span class="comment">-- 命令行窗口使用system管理员去grant授权远程连接</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> <span class="keyword">to</span> <span class="keyword">public</span>; </span><br><span class="line"><span class="comment">-- 查看远程连接</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> dba_db_links;  </span><br><span class="line"> <span class="comment">-- 创建同义词</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">public</span> <span class="keyword">synonym</span> stu <span class="keyword">for</span> student;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu;	</span><br><span class="line"><span class="comment">--删除同义词</span></span><br><span class="line"><span class="keyword">drop</span>  <span class="keyword">synonym</span> remote ;</span><br><span class="line"><span class="comment">-- 删除远程连接</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">link</span> linkname;</span><br><span class="line"><span class="comment">-- ORACLE 查找所有同义词</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SYS.ALL_SYNONYMS t <span class="keyword">WHERE</span> t.owner <span class="keyword">in</span> (<span class="string">'C##HACHI'</span>);</span><br><span class="line"><span class="comment">----------------------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">------------------------------------   A机   ---------------------------------------------- </span></span><br><span class="line">conn sys/a123456 as sysdba; </span><br><span class="line"><span class="comment">-- 授予所有用户连接权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">connect</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- 授予所有用户创建远程连接权限，这样所有用户都可以创建和删除远程连接 database link</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- 授予所有用户创建同义词的权限,这样所有用户都可以创建和删除同义词 synonym</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">CREATE</span> <span class="keyword">synonym</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- DBA用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> shj_dba <span class="keyword">IDENTIFIED</span> <span class="keyword">by</span> a123456;</span><br><span class="line"><span class="keyword">grant</span> dba,<span class="keyword">connect</span>,<span class="keyword">resource</span> <span class="keyword">to</span> shj_dba;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">------------------------------------   B机   ---------------------------------------------- </span></span><br><span class="line">conn sys/a123456 as sysdba; </span><br><span class="line"><span class="comment">-- 授予所有用户连接权限</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">connect</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- 授予所有用户创建远程连接权限，这样所有用户都可以创建和删除远程连接 database link</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">LINK</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- 授予所有用户创建同义词的权限,这样所有用户都可以创建和删除同义词 synonym</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">CREATE</span> <span class="keyword">synonym</span> <span class="keyword">to</span> <span class="keyword">public</span>;</span><br><span class="line"><span class="comment">-- DBA用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> c<span class="comment">##hachi IDENTIFIED by a123456;</span></span><br><span class="line"><span class="keyword">grant</span> dba,<span class="keyword">connect</span>,<span class="keyword">resource</span> <span class="keyword">to</span> c<span class="comment">##hachi;</span></span><br></pre></td></tr></table></figure>

<h2 id="五、双方各自创建的DBA账户再创建其他用户，以及私有同义词"><a href="#五、双方各自创建的DBA账户再创建其他用户，以及私有同义词" class="headerlink" title="五、双方各自创建的DBA账户再创建其他用户，以及私有同义词"></a>五、双方各自创建的DBA账户再创建其他用户，以及私有同义词</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">------------------------------------   B机   ---------------------------------------------- </span></span><br><span class="line">conn c<span class="comment">##hachi/a123456;</span></span><br><span class="line"><span class="comment">-- 供应商用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> c<span class="comment">##supplier IDENTIFIED by a123456 ;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span>  <span class="string">"supplier"</span> <span class="keyword">to</span> c<span class="comment">##supplier;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span> <span class="string">"supply_info"</span> <span class="keyword">to</span> c<span class="comment">##supplier;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"part"</span> <span class="keyword">to</span> c<span class="comment">##supplier;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"project"</span> <span class="keyword">to</span> c<span class="comment">##supplier;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 领导用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> c<span class="comment">##leader IDENTIFIED by a123456 ;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span> <span class="string">"staff"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"supplier"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"supply_info"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"project"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"part"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"storage"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"storage_info"</span> <span class="keyword">to</span> c<span class="comment">##leader;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 职工用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> c<span class="comment">##staff IDENTIFIED by a123456;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"staff"</span> <span class="keyword">to</span> c<span class="comment">##staff;</span></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"storage"</span> <span class="keyword">to</span> c<span class="comment">##staff;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建4个不同用户权限的远程连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">conn</span> c<span class="comment">##hachi/a123456;</span></span><br><span class="line"><span class="comment">-- 本机DBA用户c##hachi，使用对方的DBA账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  shj0dba   <span class="keyword">connect</span> <span class="keyword">to</span> shj_dba <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"a123456"</span> <span class="keyword">using</span> <span class="string">'10.65.252.84/orcl'</span>;</span><br><span class="line"><span class="comment">-- 创建同义词</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> <span class="string">"part"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> <span class="string">"project"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> <span class="string">"staff"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> <span class="string">"storage"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage_info <span class="keyword">for</span> <span class="string">"storage_info"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> <span class="string">"supplier"</span>@shj0dba;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> <span class="string">"supply_info"</span>@shj0dba;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">conn c<span class="comment">##leader/a123456;</span></span><br><span class="line"><span class="comment">-- 本机领导用户c##leader，使用对方的领导账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  shj0leader   <span class="keyword">connect</span> <span class="keyword">to</span> shj_leader <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"a123456"</span> <span class="keyword">using</span> <span class="string">'10.65.252.84/orcl'</span>;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> shj_dba.<span class="string">"part"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> shj_dba.<span class="string">"project"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> shj_dba.<span class="string">"staff"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> shj_dba.<span class="string">"storage"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage_info <span class="keyword">for</span> shj_dba.<span class="string">"storage_info"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> shj_dba.<span class="string">"supplier"</span>@shj0leader;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> shj_dba.<span class="string">"supply_info"</span>@shj0leader;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"> <span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line">conn c<span class="comment">##supplier/a123456;</span></span><br><span class="line"><span class="comment">-- 本机供应商用户c##supplier，使用对方的供应商账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  shj0supplier   <span class="keyword">connect</span> <span class="keyword">to</span> shj_supplier <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"a123456"</span> <span class="keyword">using</span> <span class="string">'10.65.252.84/orcl'</span>;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> shj_dba.<span class="string">"part"</span>@shj0supplier;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> shj_dba.<span class="string">"project"</span>@shj0supplier;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> shj_dba.<span class="string">"supplier"</span>@shj0supplier;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> shj_dba.<span class="string">"supply_info"</span>@shj0supplier;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"> <span class="keyword">commit</span>;</span><br><span class="line"> </span><br><span class="line">conn c<span class="comment">##staff/a123456;</span></span><br><span class="line"><span class="comment">-- 本机员工用户c##staff，使用对方的员工账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  shj0staff   <span class="keyword">connect</span> <span class="keyword">to</span> shj_staff <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"a123456"</span> <span class="keyword">using</span> <span class="string">'10.65.252.84/orcl'</span>;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> shj_dba.<span class="string">"staff"</span>@shj0staff ;</span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> shj_dba.<span class="string">"storage"</span>@shj0staff;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_staff;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023011729.png" alt="image-20201023011729623"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">------------------------------------   A机   ---------------------------------------------- </span></span><br><span class="line">conn shj_dba/a123456;</span><br><span class="line"><span class="comment">-- 供应商用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> shj_supplier <span class="keyword">IDENTIFIED</span> <span class="keyword">by</span> a123456 ;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span>  <span class="string">"supplier"</span> <span class="keyword">to</span> shj_supplier;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span> <span class="string">"supply_info"</span> <span class="keyword">to</span> shj_supplier;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"part"</span> <span class="keyword">to</span> shj_supplier;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"project"</span> <span class="keyword">to</span> shj_supplier;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 领导用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> shj_leader <span class="keyword">IDENTIFIED</span> <span class="keyword">by</span> a123456 ;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span> <span class="keyword">on</span> <span class="string">"staff"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"supplier"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"supply_info"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>  <span class="keyword">on</span> <span class="string">"project"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"part"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"storage"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span>,<span class="keyword">INSERT</span>,<span class="keyword">DELETE</span>,<span class="keyword">UPDATE</span>  <span class="keyword">on</span> <span class="string">"storage_info"</span> <span class="keyword">to</span> shj_leader;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 职工用户创建及授权</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> shj_staff <span class="keyword">IDENTIFIED</span> <span class="keyword">by</span> a123456;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"staff"</span> <span class="keyword">to</span> shj_staff;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">SELECT</span> <span class="keyword">on</span> <span class="string">"storage"</span> <span class="keyword">to</span> shj_staff;</span><br><span class="line"> <span class="keyword">commit</span>;</span><br><span class="line"> </span><br><span class="line"> <span class="comment">-- 删除同名同义词与连接</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_part;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_project;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_staff;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_storage;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_storage_info;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_supplier;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">SYNONYM</span> remote_supply_info;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">link</span> c<span class="comment">##0hachi;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建4个不同用户权限的远程连接</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">conn</span> shj_dba/a123456;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 本机DBA用户shj_dba，使用对方的DBA账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  c<span class="comment">##0hachi connect to "c##hachi" identified by "a123456" using '10.82.156.248/orcl';</span></span><br><span class="line"><span class="comment">-- 创建同义词</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> <span class="string">"part"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> <span class="string">"project"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> <span class="string">"staff"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> <span class="string">"storage"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage_info <span class="keyword">for</span> <span class="string">"storage_info"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> <span class="string">"supplier"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> <span class="string">"supply_info"</span>@c<span class="comment">##0hachi;</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">conn shj_leader/a123456;</span><br><span class="line"><span class="comment">-- 本机领导用户shj_leader，使用对方的领导账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  c<span class="comment">##0leader   connect to "c##leader" identified by "a123456" using '10.82.156.248/orcl';</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> c<span class="comment">##hachi."part"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> c<span class="comment">##hachi."project"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> c<span class="comment">##hachi."staff"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> c<span class="comment">##hachi."storage"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage_info <span class="keyword">for</span> c<span class="comment">##hachi."storage_info"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> c<span class="comment">##hachi."supplier"@c##0leader;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> c<span class="comment">##hachi."supply_info"@c##0leader;</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"> <span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line">conn shj_supplier/a123456;</span><br><span class="line"><span class="comment">-- 本机供应商用户shj_supplier，使用对方的供应商账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  c<span class="comment">##0supplier   connect to "c##supplier" identified by "a123456" using '10.82.156.248/orcl';</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_part <span class="keyword">for</span> c<span class="comment">##hachi."part"@c##0supplier;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_project <span class="keyword">for</span> c<span class="comment">##hachi."project"@c##0supplier;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supplier <span class="keyword">for</span> c<span class="comment">##hachi."supplier"@c##0supplier;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_supply_info <span class="keyword">for</span> c<span class="comment">##hachi."supply_info"@c##0supplier;</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_supply_info;</span><br><span class="line"> <span class="keyword">commit</span>;</span><br><span class="line"> </span><br><span class="line">conn shj_staff/a123456;</span><br><span class="line"><span class="comment">-- 本机员工用户shj_staff，使用对方的员工账户登录远程连接</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">database</span> <span class="keyword">link</span>  c<span class="comment">##0staff   connect to "c##staff" identified by "a123456" using '10.82.156.248/orcl';</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_staff <span class="keyword">for</span> c<span class="comment">##hachi."staff"@c##0staff ;</span></span><br><span class="line"><span class="keyword">create</span>  <span class="keyword">synonym</span> remote_storage <span class="keyword">for</span> c<span class="comment">##hachi."storage"@c##0staff;</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> remote_staff;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023011822.png" alt="image-20201023011822446"></p>
<blockquote>
<p>因为使用的wifi网络，采用DHCP协议动态分配IP地址，所以每一次两台笔记本的IP地址是不一样的，所以连接得删了再重新建立，同义词不用删了重新建立，重新创建一下database link连接就行了。<br>我这里建的都是私有连接，私有同义词，只有创建该连接的用户才可以使用，其他用户没有使用权限，是透明的，所以设置同名的同义词不影响。</p>
</blockquote>
<ul>
<li>同义词创建后就可以使用同义词去增删改查对方的表了，这里贴两张图，各自私有建的连接，不影响各自的同名同义词。</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023012624.png" alt="image-20201023012624628">)<img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023012748.png" alt="image-20201023012748914"></p>
<h2 id="六、创建同步触发器与存储过程"><a href="#六、创建同步触发器与存储过程" class="headerlink" title="六、创建同步触发器与存储过程"></a>六、创建同步触发器与存储过程</h2><ol>
<li><p>可能由于版本问题，B机12C可以创建触发器同步备份A机的上的表，而A机不行。同时B机创建存储过程，执行存储过程，会触发B机的触发器去同步更新A机上的表。</p>
</li>
<li><p>A机可以使用连接更新B机的数据，同时触发触发器更新A机自己的表。</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023153322.png" alt="123"></p>
</li>
</ol>
<p>下面以图文结合方式说明以上两点。</p>
<p><code>这里触发器和存储过程都建在c##hachi用户模式下。</code></p>
<h3 id="6-1-触发器"><a href="#6-1-触发器" class="headerlink" title="6.1 触发器"></a>6.1 触发器</h3><p>触发器代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">------------------------------------   B机 c##hachi模式下创建   ---------------------------------------------- </span></span><br><span class="line"><span class="comment">-- 增删改part</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_part;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_part <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"part"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span>  </span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_part(<span class="string">"p_id"</span>,<span class="string">"p_name"</span>,<span class="string">"p_size"</span>,<span class="string">"p_price"</span>,<span class="string">"p_desc"</span>) <span class="keyword">values</span>(:new.<span class="string">"p_id"</span>,:new.<span class="string">"p_name"</span>,:new.<span class="string">"p_size"</span>,:new.<span class="string">"p_price"</span>,:new.<span class="string">"p_desc"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_part <span class="keyword">set</span>  remote_part.<span class="string">"p_name"</span>=:new.<span class="string">"p_name"</span>,remote_part.<span class="string">"p_size"</span>=:new.<span class="string">"p_size"</span>,remote_part.<span class="string">"p_price"</span>=:new.<span class="string">"p_price"</span>,remote_part.<span class="string">"p_desc"</span>=:new.<span class="string">"p_desc"</span> <span class="keyword">where</span> remote_part.<span class="string">"p_id"</span>=:new.<span class="string">"p_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_part <span class="keyword">where</span> remote_part.<span class="string">"p_id"</span>=:old.<span class="string">"p_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"part"</span> <span class="keyword">values</span>(<span class="number">9</span>,<span class="string">'eeeee'</span>,<span class="number">22</span>,<span class="number">12</span>,<span class="string">'eeeeee'</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"part"</span> <span class="keyword">set</span> <span class="string">"p_name"</span>=<span class="string">'abc'</span>,<span class="string">"p_size"</span>=<span class="number">11</span>,<span class="string">"p_price"</span>=<span class="number">11</span>,<span class="string">"p_desc"</span>=<span class="string">'abc'</span> <span class="keyword">where</span> <span class="string">"p_id"</span>=<span class="number">9</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"part"</span> <span class="keyword">where</span> <span class="string">"p_id"</span>=<span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"><span class="comment">-- 增删改project</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_project;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_project <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"project"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_project(<span class="string">"pj_id"</span>,<span class="string">"pj_money"</span>,<span class="string">"pj_date"</span>) <span class="keyword">values</span>(:new.<span class="string">"pj_id"</span>,:new.<span class="string">"pj_money"</span>,:new.<span class="string">"pj_date"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_project <span class="keyword">set</span>  remote_project.<span class="string">"pj_money"</span>=:new.<span class="string">"pj_money"</span>,remote_project.<span class="string">"pj_date"</span>=:new.<span class="string">"pj_date"</span> <span class="keyword">where</span> remote_project.<span class="string">"pj_id"</span>=:new.<span class="string">"pj_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_project <span class="keyword">where</span> remote_project.<span class="string">"pj_id"</span>=:old.<span class="string">"pj_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"project"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">100</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"project"</span> <span class="keyword">set</span> <span class="string">"pj_money"</span>=<span class="number">200</span>,<span class="string">"pj_date"</span>=<span class="literal">null</span> <span class="keyword">where</span> <span class="string">"pj_id"</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"project"</span> <span class="keyword">where</span> <span class="string">"pj_id"</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增删改staff</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_staff;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_staff <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"staff"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_staff(<span class="string">"sf_id"</span>,<span class="string">"s_id"</span>,<span class="string">"sta_sf_id"</span>,<span class="string">"sf_name"</span>,<span class="string">"sf_age"</span>,<span class="string">"sf_xname"</span>) <span class="keyword">values</span>(:new.<span class="string">"sf_id"</span>,:new.<span class="string">"s_id"</span>,:new.<span class="string">"sta_sf_id"</span>,:new.<span class="string">"sf_name"</span>,:new.<span class="string">"sf_age"</span>,:new.<span class="string">"sf_xname"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_staff <span class="keyword">set</span>  remote_staff.<span class="string">"sf_name"</span>=:new.<span class="string">"sf_name"</span>,remote_staff.<span class="string">"sf_age"</span>=:new.<span class="string">"sf_age"</span>,remote_staff.<span class="string">"sf_xname"</span>=:new.<span class="string">"sf_xname"</span> <span class="keyword">where</span> remote_staff.<span class="string">"sf_id"</span>=:new.<span class="string">"sf_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_staff <span class="keyword">where</span> remote_staff.<span class="string">"sf_id"</span>=:old.<span class="string">"sf_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"staff"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="string">'Hachi'</span>,<span class="number">10</span>,<span class="string">'Bit'</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"staff"</span> <span class="keyword">set</span> <span class="string">"sf_name"</span>=<span class="string">'BitHachi'</span>,<span class="string">"sf_xname"</span>=<span class="string">'bithachi'</span> <span class="keyword">where</span> <span class="string">"sf_id"</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"staff"</span> <span class="keyword">where</span> <span class="string">"sf_id"</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增删改storage</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_storage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_storage <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"storage"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_storage(<span class="string">"s_id"</span>,<span class="string">"s_area"</span>,<span class="string">"s_phone"</span>) <span class="keyword">values</span>(:new.<span class="string">"s_id"</span>,:new.<span class="string">"s_area"</span>,:new.<span class="string">"s_phone"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_storage <span class="keyword">set</span>  remote_storage.<span class="string">"s_area"</span>=:new.<span class="string">"s_area"</span>,remote_storage.<span class="string">"s_phone"</span>=:new.<span class="string">"s_phone"</span> <span class="keyword">where</span> remote_storage.<span class="string">"s_id"</span>=:new.<span class="string">"s_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_storage <span class="keyword">where</span> remote_storage.<span class="string">"s_id"</span>=:old.<span class="string">"s_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"storage"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">100</span>,<span class="string">'17683738511'</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"storage"</span> <span class="keyword">set</span> <span class="string">"s_area"</span>=<span class="number">200</span>,<span class="string">"s_phone"</span>=<span class="string">'17683838555'</span> <span class="keyword">where</span> <span class="string">"s_id"</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"storage"</span> <span class="keyword">where</span> <span class="string">"s_id"</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增删改storage_info</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_storage_info;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_storage_info <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"storage_info"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_storage_info(<span class="string">"s_id"</span>,<span class="string">"p_id"</span>,<span class="string">"sf_num"</span>) <span class="keyword">values</span>(:new.<span class="string">"s_id"</span>,:new.<span class="string">"p_id"</span>,:new.<span class="string">"sf_num"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_storage_info <span class="keyword">set</span>  remote_storage_info.<span class="string">"sf_num"</span>=:new.<span class="string">"sf_num"</span>  <span class="keyword">where</span> remote_storage_info.<span class="string">"s_id"</span>=:new.<span class="string">"s_id"</span> <span class="keyword">and</span> remote_storage_info.<span class="string">"p_id"</span>=:new.<span class="string">"p_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_storage_info <span class="keyword">where</span> remote_storage_info.<span class="string">"s_id"</span>=:old.<span class="string">"s_id"</span> <span class="keyword">and</span> remote_storage_info.<span class="string">"p_id"</span>=:old.<span class="string">"p_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"storage_info"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"storage_info"</span> <span class="keyword">set</span> <span class="string">"sf_num"</span>=<span class="number">200</span>  <span class="keyword">where</span> <span class="string">"s_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"p_id"</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"storage_info"</span> <span class="keyword">where</span> <span class="string">"s_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"p_id"</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增删改supplier</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_supplier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_supplier <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"supplier"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_supplier(<span class="string">"sp_id"</span>,<span class="string">"sp_name"</span>,<span class="string">"sp_address"</span>,<span class="string">"sp_phone"</span>,<span class="string">"sp_acount"</span>) <span class="keyword">values</span>(:new.<span class="string">"sp_id"</span>,:new.<span class="string">"sp_name"</span>,:new.<span class="string">"sp_address"</span>,:new.<span class="string">"sp_phone"</span>,:new.<span class="string">"sp_acount"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_supplier <span class="keyword">set</span>  remote_supplier.<span class="string">"sp_name"</span>=:new.<span class="string">"sp_name"</span>  <span class="keyword">where</span> remote_supplier.<span class="string">"sp_id"</span>=:new.<span class="string">"sp_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_supplier <span class="keyword">where</span> remote_supplier.<span class="string">"sp_id"</span>=:old.<span class="string">"sp_id"</span> ;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"supplier"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'BitHachi'</span>,<span class="string">'中国湖北'</span>,<span class="string">'17683738511'</span>,<span class="string">'1000001'</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"supplier"</span> <span class="keyword">set</span> <span class="string">"sp_name"</span>=<span class="string">'Hachi'</span>  <span class="keyword">where</span> <span class="string">"sp_id"</span>=<span class="number">1</span>  ;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"supplier"</span> <span class="keyword">where</span>  <span class="string">"sp_id"</span>=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增删改supply_info</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">trigger</span> insert_update_delete_supply_info;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">trigger</span> insert_update_delete_supply_info <span class="keyword">after</span> <span class="keyword">insert</span> <span class="keyword">or</span> <span class="keyword">update</span> <span class="keyword">or</span> <span class="keyword">delete</span></span><br><span class="line"><span class="keyword">on</span>  <span class="string">"supply_info"</span> <span class="keyword">for</span> <span class="keyword">each</span> <span class="keyword">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> inserting <span class="keyword">then</span></span><br><span class="line">			 <span class="keyword">insert</span> <span class="keyword">into</span> remote_supply_info(<span class="string">"p_id"</span>,<span class="string">"pj_id"</span>,<span class="string">"sp_id"</span>,<span class="string">"sp_num"</span>) <span class="keyword">values</span>(:new.<span class="string">"p_id"</span>,:new.<span class="string">"pj_id"</span>,:new.<span class="string">"sp_id"</span>,:new.<span class="string">"sp_num"</span>);</span><br><span class="line">	elsif updating then</span><br><span class="line">			  <span class="keyword">update</span> remote_supply_info <span class="keyword">set</span>  remote_supply_info.<span class="string">"sp_num"</span>=:new.<span class="string">"sp_num"</span>  <span class="keyword">where</span> remote_supply_info.<span class="string">"p_id"</span>=:new.<span class="string">"p_id"</span> <span class="keyword">and</span> remote_supply_info.<span class="string">"pj_id"</span>=:new.<span class="string">"pj_id"</span> <span class="keyword">and</span> remote_supply_info.<span class="string">"sp_id"</span>=:new.<span class="string">"sp_id"</span>;</span><br><span class="line">	elsif deleting then </span><br><span class="line">			 <span class="keyword">delete</span> <span class="keyword">from</span> remote_supply_info <span class="keyword">where</span> remote_supply_info.<span class="string">"p_id"</span>=:old.<span class="string">"p_id"</span> <span class="keyword">and</span> remote_supply_info.<span class="string">"pj_id"</span>=:old.<span class="string">"pj_id"</span> <span class="keyword">and</span> remote_supply_info.<span class="string">"sp_id"</span>=:old.<span class="string">"sp_id"</span>;</span><br><span class="line">	<span class="keyword">end</span> <span class="keyword">if</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">"supply_info"</span> <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">100</span>);</span><br><span class="line"><span class="keyword">update</span> <span class="string">"supply_info"</span> <span class="keyword">set</span> <span class="string">"sp_num"</span>=<span class="number">200</span>  <span class="keyword">where</span> <span class="string">"p_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"pj_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"sp_id"</span>=<span class="number">1</span> ;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="string">"supply_info"</span> <span class="keyword">where</span> <span class="string">"p_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"pj_id"</span>=<span class="number">1</span> <span class="keyword">and</span> <span class="string">"sp_id"</span>=<span class="number">1</span> ;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>这里触发器很多，我就演示一个。见下图：</p>
<p>这张图是B机创建一个触发器实现remote_part同义词表示的A机的part表的同步更新。</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023014536.png" alt="image-20201023014536530"></p>
<p>现在我们在A机上使用同义词进行插入、修改、删除，会触发B机的触发器同步更新B机和A机的表数据。</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023015836.png" alt="img"></p>
<h3 id="6-2存储过程"><a href="#6-2存储过程" class="headerlink" title="6.2存储过程"></a>6.2存储过程</h3><p>这里B机创建了一个存储过程，B机调用存储过程可以实现B机和A机的同步更新。</p>
<p>先贴代码再放截图流程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> select_data;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> select_data </span><br><span class="line">(var_datas <span class="keyword">out</span> sys_refcursor) <span class="keyword">AS</span>  </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line">	<span class="keyword">OPEN</span> var_datas <span class="keyword">for</span> <span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">"part"</span>; </span><br><span class="line"><span class="keyword">end</span> select_data;</span><br><span class="line">var datas refcursor;</span><br><span class="line">exec select_data(:datas);</span><br><span class="line">print:datas;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 增加数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> insert_data;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> insert_data</span><br><span class="line">(var_id <span class="string">"part"</span>.<span class="string">"p_id"</span>%<span class="keyword">TYPE</span>,var_name <span class="string">"part"</span>.<span class="string">"p_name"</span>%<span class="keyword">TYPE</span>,var_size <span class="string">"part"</span>.<span class="string">"p_size"</span>%<span class="keyword">TYPE</span>,var_price <span class="string">"part"</span>.<span class="string">"p_price"</span>%<span class="keyword">TYPE</span>,var_desc <span class="string">"part"</span>.<span class="string">"p_desc"</span>%<span class="keyword">TYPE</span>) </span><br><span class="line"><span class="keyword">AS</span>   </span><br><span class="line"><span class="keyword">begin</span>  </span><br><span class="line">	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">"part"</span> <span class="keyword">values</span>(var_id,var_name,var_size,var_price,var_desc);</span><br><span class="line"><span class="keyword">end</span> insert_data;</span><br><span class="line">exec insert_data(2,'ANIVJO',22,15,'DFGDG');</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> update_data;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> update_data</span><br><span class="line">(var_id <span class="string">"part"</span>.<span class="string">"p_id"</span>%<span class="keyword">TYPE</span>,var_name <span class="string">"part"</span>.<span class="string">"p_name"</span>%<span class="keyword">TYPE</span>)  </span><br><span class="line"><span class="keyword">AS</span>  </span><br><span class="line"><span class="keyword">begin</span>  </span><br><span class="line">	<span class="keyword">UPDATE</span> <span class="string">"part"</span> <span class="keyword">SET</span> <span class="string">"p_name"</span>=var_name  <span class="keyword">WHERE</span> <span class="string">"p_id"</span>=var_id;</span><br><span class="line"><span class="keyword">end</span> update_data;</span><br><span class="line">exec update_data(2,'BitHachi');</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除数据</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> delete_data;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> delete_data</span><br><span class="line">(var_id <span class="string">"part"</span>.<span class="string">"p_id"</span>%<span class="keyword">TYPE</span>)  </span><br><span class="line"><span class="keyword">AS</span>  </span><br><span class="line"><span class="keyword">begin</span>  </span><br><span class="line">	<span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="string">"part"</span> <span class="keyword">WHERE</span> <span class="string">"p_id"</span>=var_id;</span><br><span class="line"><span class="keyword">end</span> delete_data;</span><br><span class="line">exec delete_data(2);</span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201023020723.png" alt="image-20201023020723206"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">BitHachi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.bithachi.cn/posts/198e6f50.html">https://www.bithachi.cn/posts/198e6f50.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.bithachi.cn" target="_blank">BitHachi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Oracle/">Oracle</a><a class="post-meta__tags" href="/tags/Database/">Database</a><a class="post-meta__tags" href="/tags/trigger/">trigger</a><a class="post-meta__tags" href="/tags/procedure/">procedure</a></div><div class="post_share"></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.png" alt="微信" onclick="window.open('/img/wechat.png')"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.png" alt="支付宝" onclick="window.open('/img/alipay.png')"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/cc4f65f8.html"><img class="prev-cover" data-src="https://image.bithachi.cn/earth-11595_1280.webp" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Servlet入门篇</div></div></a></div><div class="next-post pull-right"><a href="/posts/50fa6455.html"><img class="next-cover" data-src="https://cdn.pixabay.com/photo/2017/10/12/20/15/photoshop-2845779_1280.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">前后台json交互，以及数据库json转换——PHP&amp;Thinkphp5.1</div></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'NRvlHdgJSxUn4u8Q1sgVDnlP-gzGzoHsz',
  appKey: '5sa3oi8Nwmzfo8zdXrnvibI0',
  placeholder: '记得留下你的昵称和邮箱....可以快速收到回复',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" style="background-image: url(https://cdn.pixabay.com/photo/2017/09/26/02/41/swim-2787543_1280.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By BitHachi</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my blog.</div><div class="icp"><a href="http://www.beian.gov.cn/" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>鄂ICP备20002680号</span></a></div></div><div class="container" id="jsi-flying-fish-container"></div><script src="js/fish.js"></script><style>@media only screen and (max-width: 767px){
#sidebar_search_box input[type=text]{width:calc(100%)}
}</style></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">简</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fas fa-comments"></i></a><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/click_heart.js"></script><script src="https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  pangu.autoSpacingPage()
})</script><script src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fish.js"></script></body></html>