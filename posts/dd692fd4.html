<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SpringBoot之Spring Data JPA | BitHachi</title><meta name="description" content="1. Spring Data JPA简介​    JPA（Java Persistence API）是官方提出的Java持久化规范。JPA通过注解或XML描述对象—关系（表）的映射关系，并将内存中的实体对象持久化到数据库。​    Spring Data JPA通过提供基于JPA的Repository极大地简化了JPA的写法，在几乎不写实现的情况下，实现数据库的访问和操作。使用Spring Dat"><meta name="keywords" content="Spring Data JPA,SpringBoot"><meta name="author" content="BitHachi"><meta name="copyright" content="BitHachi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.bithachi.cn/posts/dd692fd4.html"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//ta.qq.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="baidu-site-verification" content="3VJlgEduPjcVcUAR"/><meta property="og:type" content="article"><meta property="og:title" content="SpringBoot之Spring Data JPA"><meta property="og:url" content="https://www.bithachi.cn/posts/dd692fd4.html"><meta property="og:site_name" content="BitHachi"><meta property="og:description" content="1. Spring Data JPA简介​    JPA（Java Persistence API）是官方提出的Java持久化规范。JPA通过注解或XML描述对象—关系（表）的映射关系，并将内存中的实体对象持久化到数据库。​    Spring Data JPA通过提供基于JPA的Repository极大地简化了JPA的写法，在几乎不写实现的情况下，实现数据库的访问和操作。使用Spring Dat"><meta property="og:image" content="https://cdn.pixabay.com/photo/2016/11/18/13/13/animal-1834401__340.jpg"><meta property="article:published_time" content="2020-12-29T02:58:33.924Z"><meta property="article:modified_time" content="2021-01-03T07:22:44.071Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = '2'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="SpringBoot：(异步,定时,邮件)任务" href="https://www.bithachi.cn/posts/a5513b53.html"><link rel="next" title="SpringBoot整合(JDBC,Druid,Mybatis)+JDBCTemplate案例" href="https://www.bithachi.cn/posts/b5592004.html"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8f5f31c25712dd1fb6414ae53fd6ecaf";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-171838759-1', 'auto');
ga('send', 'pageview');
</script><script src="https://tajs.qq.com/stats?sId=66572961" charset="UTF-8"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: BitHachi","link":"链接: ","source":"来源: BitHachi","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: false,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"top-center"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="baidu-site-verification" content="V1TxT1VCnF" /><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/bithachi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">78</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">123</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">17</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books"><i class="fa-fw fa fa-bookmark"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/MessageBoard/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Spring-Data-JPA简介"><span class="toc-text">1. Spring Data JPA简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-JpaRepository接口提供的常用方法"><span class="toc-text">2. JpaRepository接口提供的常用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Spring-Data-JPA模块的依赖关系"><span class="toc-text">3.  Spring Data JPA模块的依赖关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-JPA查询命名规则"><span class="toc-text">4. JPA查询命名规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-限制查询结果数量"><span class="toc-text">5. 限制查询结果数量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-JPA实现关联查询"><span class="toc-text">6. JPA实现关联查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-项目的完整文件夹结构"><span class="toc-text">6.1 项目的完整文件夹结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-数据库表"><span class="toc-text">6.2 数据库表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-application-yml文件与pom-xml"><span class="toc-text">6.3 application.yml文件与pom.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-OneToOne"><span class="toc-text">6.4 @OneToOne</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-1-Person和IdCard实体类"><span class="toc-text">6.4.1 Person和IdCard实体类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-2-PersonRepository和IdCardRepository数据访问层"><span class="toc-text">6.4.2 PersonRepository和IdCardRepository数据访问层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-3-PersonAndIdCardService和PersonAndIdCardServiceImpl服务层"><span class="toc-text">6.4.3 PersonAndIdCardService和PersonAndIdCardServiceImpl服务层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-4-TestOneToOneController控制层"><span class="toc-text">6.4.4 TestOneToOneController控制层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-OneToMany和-ManyToOne"><span class="toc-text">6.5 @OneToMany和@ManyToOne</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-1-Author和Article实体类"><span class="toc-text">6.5.1 Author和Article实体类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-ArticleRepository和AuthorRepository数据访问层"><span class="toc-text">6.5.2 ArticleRepository和AuthorRepository数据访问层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-3-AuthorAndArticleService和AuthorAndArticleServiceImpl服务层"><span class="toc-text">6.5.3 AuthorAndArticleService和AuthorAndArticleServiceImpl服务层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-4-TestOneToManyController控制层"><span class="toc-text">6.5.4 TestOneToManyController控制层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-ManyToMany"><span class="toc-text">6.6 @ManyToMany</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-1-Authority和User实体类"><span class="toc-text">6.6.1 Authority和User实体类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-2-UserRepository和AuthorityRepository数据访问层"><span class="toc-text">6.6.2 UserRepository和AuthorityRepository数据访问层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-3-UserAndAuthorityService和UserAndAuthorityServiceImpl服务层"><span class="toc-text">6.6.3 UserAndAuthorityService和UserAndAuthorityServiceImpl服务层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-6-4-TestManyToManyController控制层"><span class="toc-text">6.6.4 TestManyToManyController控制层</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.pixabay.com/photo/2016/11/18/13/13/animal-1834401__340.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">BitHachi</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/books"><i class="fa-fw fa fa-bookmark"></i><span> 阅读</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/MessageBoard/"><i class="fa-fw fa fa-comment"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">SpringBoot之Spring Data JPA</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-12-29 10:58:33 10:58:33"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-12-29 10:58:33</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-03 15:22:44 15:22:44"><i class="fas fa-history fa-fw"></i> 更新于 2021-01-03 15:22:44</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><i class="fas fa-angle-right post-meta__separator"></i><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Java/SpringBoot/">SpringBoot</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">5.9k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 29 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="far fa-comments fa-fw post-meta__icon"></i><span>评论数:</span><a href="/posts/dd692fd4.html#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/posts/dd692fd4.html" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="1-Spring-Data-JPA简介"><a href="#1-Spring-Data-JPA简介" class="headerlink" title="1. Spring Data JPA简介"></a>1. Spring Data JPA简介</h2><p>​    JPA（Java Persistence API）是官方提出的<code>Java持久化规范</code>。JPA通过注解或XML描述对象—关系（表）的映射关系，并将内存中的实体对象持久化到数据库。<br>​    Spring Data JPA通过提供基于JPA的Repository极大地简化了JPA的写法，在几乎不写实现的情况下，实现数据库的访问和操作。使用Spring Data JPA建立数据访问层十分方便，只需要定义一个继承JpaRepository接口的接口即可。</p>
<h2 id="2-JpaRepository接口提供的常用方法"><a href="#2-JpaRepository接口提供的常用方法" class="headerlink" title="2. JpaRepository接口提供的常用方法"></a>2. JpaRepository接口提供的常用方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">()</span>：<span class="comment">//查询所有实体对象数据，返回一个List集合。</span></span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">(Sort sort)</span>：<span class="comment">//按照指定的排序规则查询所有实体对象数据，返回一个List集合。</span></span></span><br><span class="line"><span class="function">List&lt;T&gt; <span class="title">findAllById</span><span class="params">(Iterable&lt;ID&gt; ids)</span>：<span class="comment">//根据所提供的实体对象id（多个），将对应的实体全部查询出来，并返回一个List集合。</span></span></span><br><span class="line"><span class="function">&lt;S extends T&gt; List&lt;S&gt; <span class="title">saveAll</span><span class="params">(Iterable&lt;S&gt; entities)</span>：<span class="comment">//将提供的集合中的实体对象数据保存到数据库。</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span>：<span class="comment">//将缓存的对象数据操作更新到数据库。</span></span></span><br><span class="line"><span class="function">&lt;S extends T&gt; S <span class="title">saveAndFlush</span><span class="params">(S entity)</span>：<span class="comment">//保存对象的同时立即更新到数据库。</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteInBatch</span><span class="params">(Iterable&lt;T&gt; entities)</span>：<span class="comment">//批量删除提供的实体对象。</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deleteAllInBatch</span><span class="params">()</span>：<span class="comment">//批量删除所有的实体对象。</span></span></span><br><span class="line"><span class="function">T <span class="title">getOne</span><span class="params">(ID id)</span>：<span class="comment">//根据id获得对应的实体对象。</span></span></span><br><span class="line"><span class="function">&lt;S extends T&gt; List&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example)</span>：<span class="comment">//根据提供的example实例查询实体对象数据。</span></span></span><br><span class="line"><span class="function">&lt;S extends T&gt; List&lt;S&gt; <span class="title">findAll</span><span class="params">(Example&lt;S&gt; example, Sort sort)</span>：<span class="comment">//根据提供的example实例，并按照指定规则，查询实体对象数据。</span></span></span><br></pre></td></tr></table></figure>



<h2 id="3-Spring-Data-JPA模块的依赖关系"><a href="#3-Spring-Data-JPA模块的依赖关系" class="headerlink" title="3.  Spring Data JPA模块的依赖关系"></a>3.  Spring Data JPA模块的依赖关系</h2><p>​    spring-boot-starter-data-jpa依赖于spring-boot-starter-jdbc，而Spring Boot对spring-boot-starter-jdbc做了自动配置。<br>​    从DataSourceProperties类可以看出，我们可以使用“spring.datasource”为前缀的属性在application.properties配置文件中配置datasource。</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229110707.png" alt="image-20201229110706565"></p>
<p>​    从HibernateJpaAutoConfiguration类可以看出，Spring Boot对JPA的默认实现是Hibernate。从JpaProperties类可以看出，我们可以使用“spring.jpa”为前缀的属性在application.properties配置文件中配置JPA。</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229110812.png" alt="image-20201229110812190"></p>
<p>​    从JpaRepositoriesAutoConfiguration类可以看出，JpaRepositoriesAutoConfiguration依赖于HibernateJpaAutoConfiguration配置；</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229111138.png" alt="image-20201229111138500"></p>
<p>​    从上述分析可知，我们在Spring Boot应用中使用Spring Data JPA访问数据库时，除了添加spring-boot-starter-data-jpa依赖外，只需定义DataSource、持久化实体类和数据访问层，并在需要使用数据访问的地方（如Service层）依赖注入数据访问层即可。</p>
<h2 id="4-JPA查询命名规则"><a href="#4-JPA查询命名规则" class="headerlink" title="4. JPA查询命名规则"></a>4. JPA查询命名规则</h2><p>​    在自定义的数据访问接口中可以根据查询关键字定义查询方法，这些查询方法需要符合它的命名规则，一般是根据持久化实体类的属性名来确定的。</p>
<table>
<thead>
<tr>
<th align="center"><strong>关键字</strong></th>
<th align="left"><strong>示 例</strong></th>
<th align="left"><strong>JPQL代码段</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>And</strong></td>
<td align="left">findByLastnameAndFirstname</td>
<td align="left">… where x.lastname = ?1 and x.firstname = ?2</td>
</tr>
<tr>
<td align="center"><strong>Or</strong></td>
<td align="left">findByLastnameOrFirstname</td>
<td align="left">… where x.lastname = ?1 or x.firstname = ?2</td>
</tr>
<tr>
<td align="center"><strong>Is,Equals</strong></td>
<td align="left">findByFirstname,findByFirstnameIs,findByFirstnameEquals</td>
<td align="left">… where x.firstname = ?1</td>
</tr>
<tr>
<td align="center"><strong>Between</strong></td>
<td align="left">findByStartDateBetween</td>
<td align="left">… where x.startDate between ?1 and ?2</td>
</tr>
<tr>
<td align="center"><strong>LessThan</strong></td>
<td align="left">findByAgeLessThan</td>
<td align="left">… where x.age &lt; ?1</td>
</tr>
<tr>
<td align="center"><strong>LessThanEqual</strong></td>
<td align="left">findByAgeLessThanEqual</td>
<td align="left">… where x.age &lt;= ?1</td>
</tr>
<tr>
<td align="center"><strong>GreaterThan</strong></td>
<td align="left">findByAgeGreaterThan</td>
<td align="left">… where x.age &gt; ?1</td>
</tr>
<tr>
<td align="center"><strong>GreaterThanEqual</strong></td>
<td align="left">findByAgeGreaterThanEqual</td>
<td align="left">… where x.age &gt;= ?1</td>
</tr>
<tr>
<td align="center"><strong>After</strong></td>
<td align="left">findByStartDateAfter</td>
<td align="left">… where x.startDate &gt; ?1</td>
</tr>
<tr>
<td align="center"><strong>Before</strong></td>
<td align="left">findByStartDateBefore</td>
<td align="left">… where x.startDate &lt; ?1</td>
</tr>
<tr>
<td align="center"><strong>IsNull</strong></td>
<td align="left">findByAgeIsNull</td>
<td align="left">… where x.age is null</td>
</tr>
<tr>
<td align="center"><strong>IsNotNull,NotNull</strong></td>
<td align="left">findByAge(Is)NotNull</td>
<td align="left">… where x.age not null</td>
</tr>
<tr>
<td align="center"><strong>Like</strong></td>
<td align="left">findByFirstnameLike</td>
<td align="left">… where x.firstname like ?1</td>
</tr>
<tr>
<td align="center"><strong>NotLike</strong></td>
<td align="left">findByFirstnameNotLike</td>
<td align="left">… where x.firstname not like ?1</td>
</tr>
<tr>
<td align="center"><strong>StartingWith</strong></td>
<td align="left">findByFirstnameStartingWith</td>
<td align="left">… where x.firstname like ?1参数后加%，即以参数开头的模糊查询</td>
</tr>
<tr>
<td align="center"><strong>EndingWith</strong></td>
<td align="left">findByFirstnameEndingWith</td>
<td align="left">… where x.firstname like ?1参数前加%，即以参数结尾的模糊查询</td>
</tr>
<tr>
<td align="center"><strong>Containing</strong></td>
<td align="left">findByFirstnameContaining</td>
<td align="left">… where x.firstname like ?1参数两边加%，即包含参数的模糊查询</td>
</tr>
<tr>
<td align="center"><strong>OrderBy</strong></td>
<td align="left">findByAgeOrderByLastnameDesc</td>
<td align="left">… where x.age = ?1 order by x.lastname desc</td>
</tr>
<tr>
<td align="center"><strong>Not</strong></td>
<td align="left">findByLastnameNot</td>
<td align="left">… where x.lastname &lt;&gt; ?1</td>
</tr>
<tr>
<td align="center"><strong>In</strong></td>
<td align="left">findByAgeIn(Collection<Age> ages)</td>
<td align="left">… where x.age in ?1</td>
</tr>
<tr>
<td align="center"><strong>NotIn</strong></td>
<td align="left">findByAgeNotIn(Collection<Age> ages)</td>
<td align="left">… where x.age not in ?1</td>
</tr>
<tr>
<td align="center"><strong>True</strong></td>
<td align="left">findByActiveTrue()</td>
<td align="left">… where x.active = true</td>
</tr>
<tr>
<td align="center"><strong>False</strong></td>
<td align="left">findByActiveFalse()</td>
<td align="left">… where x.active = false</td>
</tr>
<tr>
<td align="center"><strong>IgnoreCase</strong></td>
<td align="left">findByFirstnameIgnoreCase</td>
<td align="left">… where UPPER(x.firstame) = UPPER(?1)</td>
</tr>
</tbody></table>
<h2 id="5-限制查询结果数量"><a href="#5-限制查询结果数量" class="headerlink" title="5. 限制查询结果数量"></a>5. 限制查询结果数量</h2><p>  在Spring Data JPA中，使用Top和First关键字限制查询结果数量。示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">MyUser</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获得符合查询条件的前10条</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;MyUser&gt; <span class="title">findTop10ByUnameLike</span><span class="params">(String uname)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获得符合查询条件的前15条</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;MyUser&gt; <span class="title">findFirst15ByUnameLike</span><span class="params">(String uname)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-JPA实现关联查询"><a href="#6-JPA实现关联查询" class="headerlink" title="6. JPA实现关联查询"></a>6. JPA实现关联查询</h2><p><strong>在Spring Data JPA中有一对一、一对多、多对多等关系映射。</strong></p>
<p>下面将会展示一对一、一对多、多对多怎么编写: 控制层,服务层,访问层和配置文件</p>
<p>并在代码中添加相关注释注释</p>
<h3 id="6-1-项目的完整文件夹结构"><a href="#6-1-项目的完整文件夹结构" class="headerlink" title="6.1 项目的完整文件夹结构"></a>6.1 项目的完整文件夹结构</h3><p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229122943.png" alt="image-20201229122943210"></p>
<h3 id="6-2-数据库表"><a href="#6-2-数据库表" class="headerlink" title="6.2 数据库表"></a>6.2 数据库表</h3><p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229124119.png" alt="image-20201229124118988"></p>
<h3 id="6-3-application-yml文件与pom-xml"><a href="#6-3-application-yml文件与pom-xml" class="headerlink" title="6.3 application.yml文件与pom.xml"></a>6.3 application.yml文件与pom.xml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">##数据源信息配置</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="comment">#数据库MySQL为8.x时，url为jdbc:mysql://localhost:3306/forstudy?useSSL=false&amp;serverTimezone=Asia/Beijing&amp;characterEncoding=utf-8</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/forstudy?useSSL=false&amp;serverTimezone=UTC&amp;characterEncoding=utf-8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line"><span class="comment">#数据库MySQL为8.x时，驱动类为com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment">#JPA持久化配置</span></span><br><span class="line"><span class="comment">#指定数据库类型</span></span><br><span class="line">  <span class="attr">jpa:</span></span><br><span class="line">    <span class="attr">database:</span> <span class="string">MYSQL</span></span><br><span class="line"><span class="comment">#指定是否在日志中显示SQL语句</span></span><br><span class="line">    <span class="attr">show-sql:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#指定自动创建、更新数据库表等配置，update表示如果数据库中存在持久化类对应的表就不创建，不存在就创建对应的表</span></span><br><span class="line">    <span class="attr">hibernate:</span></span><br><span class="line">      <span class="attr">ddl-auto:</span> <span class="string">update</span></span><br><span class="line"><span class="comment">#让控制器输出的JSON字符串格式更美观</span></span><br><span class="line">  <span class="attr">jackson:</span></span><br><span class="line">    <span class="attr">serialization:</span></span><br><span class="line">      <span class="attr">indent-output:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.bithachi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>jpa<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="6-4-OneToOne"><a href="#6-4-OneToOne" class="headerlink" title="6.4 @OneToOne"></a>6.4 @OneToOne</h3><p>一对一关系，。比如一个大学生只有一张一卡通，一张一卡通只属于一个大学生。人与身份证的关系也是一对一的关系。</p>
<p> 在Spring Data JPA中，可用两种方式描述一对一关系映射。</p>
<ul>
<li>一种是通过外键的方式(一个实体通过外键关联到另一个实体的主键)；</li>
<li>一种是通过一张关联表来保存两个实体一对一的关系。</li>
</ul>
<p>下面就以Person和IdCard举例怎么写.</p>
<h4 id="6-4-1-Person和IdCard实体类"><a href="#6-4-1-Person和IdCard实体类" class="headerlink" title="6.4.1 Person和IdCard实体类"></a>6.4.1 Person和IdCard实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.OneToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"person_table"</span>)</span><br><span class="line"><span class="comment">/**解决No serializer found for class org.hibernate.proxy.pojo.bytebuddy.ByteBuddyInterceptor*/</span></span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;<span class="comment">//自动递增的主键</span></span><br><span class="line">	<span class="keyword">private</span> String pname;</span><br><span class="line">	<span class="keyword">private</span> String psex;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> page;</span><br><span class="line">	<span class="meta">@OneToOne</span>(</span><br><span class="line">			optional = <span class="keyword">true</span>,</span><br><span class="line">			fetch = FetchType.LAZY, </span><br><span class="line">			targetEntity = IdCard<span class="class">.<span class="keyword">class</span>, </span></span><br><span class="line"><span class="class">			<span class="title">cascade</span> </span>= CascadeType.ALL</span><br><span class="line">			)</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 *指明Person对应表的id_Card_id列作为外键与IdCard对应表的id列进行关联</span></span><br><span class="line"><span class="comment">	 * unique= true 指明id_Card_id 列的值不可重复</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@JoinColumn</span>(</span><br><span class="line">			name = <span class="string">"id_Card_id"</span>,</span><br><span class="line">			referencedColumnName = <span class="string">"id"</span>,</span><br><span class="line">			unique= <span class="keyword">true</span></span><br><span class="line">			)</span><br><span class="line">	<span class="meta">@JsonIgnore</span><span class="comment">//如果A对象持有B的引用，B对象持有A的引用，这样就形成了循环引用，如果直接使用json转换会报错</span></span><br><span class="line">	<span class="keyword">private</span> IdCard idCard;</span><br><span class="line">	<span class="comment">//省略get set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.OneToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Temporal;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.TemporalType;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"idcard_table"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IdCard</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;<span class="comment">//自动递增的主键</span></span><br><span class="line">	<span class="keyword">private</span> String code;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@Temporal</span>主要是用来指明java.util.Date 或 java.util.Calendar 类型的属性具体</span></span><br><span class="line"><span class="comment">	 * 与数据库（date、time、timestamp）三个类型中的那一个进行映射</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Temporal</span>(value = TemporalType.DATE)</span><br><span class="line">	<span class="keyword">private</span> Calendar birthday;</span><br><span class="line">	<span class="keyword">private</span> String address;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * optional = false设置person属性值不能为null，也就是身份证必须有对应的主人。</span></span><br><span class="line"><span class="comment">	 * mappedBy = "idCard"与Person类中的idCard属性一致</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@OneToOne</span>(</span><br><span class="line">			optional = <span class="keyword">true</span>,</span><br><span class="line">			fetch = FetchType.LAZY, </span><br><span class="line">			targetEntity = Person<span class="class">.<span class="keyword">class</span>, </span></span><br><span class="line"><span class="class">			<span class="title">mappedBy</span> </span>= <span class="string">"idCard"</span>, </span><br><span class="line">			cascade = CascadeType.ALL</span><br><span class="line">			)</span><br><span class="line">	<span class="keyword">private</span> Person person;<span class="comment">//对应的人</span></span><br><span class="line">    <span class="comment">//省略get set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-2-PersonRepository和IdCardRepository数据访问层"><a href="#6-4-2-PersonRepository和IdCardRepository数据访问层" class="headerlink" title="6.4.2 PersonRepository和IdCardRepository数据访问层"></a>6.4.2 PersonRepository和IdCardRepository数据访问层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.IdCard;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IdCardRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">IdCard</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据人员ID查询身份信息（关联查询，根据person属性的id）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select ic from IdCard ic where ic.person.id = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">findByPerson_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据地址和身份证号查询身份信息</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select ic from IdCard ic where ic.address = ?1 and ic.code =?2</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findByAddressAndCode</span><span class="params">(String address, String code)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Person;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PersonRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Person</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据身份ID查询人员信息（关联查询，根据idCard属性的id）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select p from Person p where p.idCard.id = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">findByIdCard_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据人名和性别查询人员信息</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select p from Person p where p.pname = ?1 and p.psex = ?2</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findByPnameAndPsex</span><span class="params">(String pname, String psex)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-3-PersonAndIdCardService和PersonAndIdCardServiceImpl服务层"><a href="#6-4-3-PersonAndIdCardService和PersonAndIdCardServiceImpl服务层" class="headerlink" title="6.4.3 PersonAndIdCardService和PersonAndIdCardServiceImpl服务层"></a>6.4.3 PersonAndIdCardService和PersonAndIdCardServiceImpl服务层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.IdCard;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PersonAndIdCardService</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findAllPerson</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findAllIdCard</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">findByPerson_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findByAddressAndCode</span><span class="params">(String address, String code)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">findByIdCard_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findByPnameAndPsex</span><span class="params">(String pname, String psex)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">getOneIdCard</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">getOnePerson</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Calendar;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.IdCard;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Person;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.IdCardRepository;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.PersonRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonAndIdCardServiceImpl</span> <span class="keyword">implements</span> <span class="title">PersonAndIdCardService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> IdCardRepository idCardRepository;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> PersonRepository personRepository;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//保存身份证</span></span><br><span class="line">		IdCard ic1 = <span class="keyword">new</span> IdCard();</span><br><span class="line">		ic1.setCode(<span class="string">"123456789"</span>);</span><br><span class="line">		ic1.setAddress(<span class="string">"北京"</span>);</span><br><span class="line">		Calendar c1 = Calendar.getInstance();</span><br><span class="line">		c1.set(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">13</span>);</span><br><span class="line">		ic1.setBirthday(c1);</span><br><span class="line">		IdCard ic2 = <span class="keyword">new</span> IdCard();</span><br><span class="line">		ic2.setCode(<span class="string">"000123456789"</span>);</span><br><span class="line">		ic2.setAddress(<span class="string">"上海"</span>);</span><br><span class="line">		Calendar c2 = Calendar.getInstance();</span><br><span class="line">		c2.set(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">14</span>);</span><br><span class="line">		ic2.setBirthday(c2);</span><br><span class="line">		IdCard ic3 = <span class="keyword">new</span> IdCard();</span><br><span class="line">		ic3.setCode(<span class="string">"1111123456789"</span>);</span><br><span class="line">		ic3.setAddress(<span class="string">"广州"</span>);</span><br><span class="line">		Calendar c3 = Calendar.getInstance();</span><br><span class="line">		c3.set(<span class="number">2019</span>, <span class="number">8</span>, <span class="number">15</span>);</span><br><span class="line">		ic3.setBirthday(c3);</span><br><span class="line">		List&lt;IdCard&gt; idCards = <span class="keyword">new</span> ArrayList&lt;IdCard&gt;();</span><br><span class="line">		idCards.add(ic1);</span><br><span class="line">		idCards.add(ic2);</span><br><span class="line">		idCards.add(ic3);</span><br><span class="line">		idCardRepository.saveAll(idCards);</span><br><span class="line">		<span class="comment">//保存人员</span></span><br><span class="line">		Person p1 = <span class="keyword">new</span> Person();</span><br><span class="line">		p1.setPname(<span class="string">"小明1"</span>);</span><br><span class="line">		p1.setPsex(<span class="string">"男"</span>);</span><br><span class="line">		p1.setPage(<span class="number">88</span>);</span><br><span class="line">		p1.setIdCard(ic1);</span><br><span class="line">		Person p2 = <span class="keyword">new</span> Person();</span><br><span class="line">		p2.setPname(<span class="string">"小明2"</span>);</span><br><span class="line">		p2.setPsex(<span class="string">"女"</span>);</span><br><span class="line">		p2.setPage(<span class="number">99</span>);</span><br><span class="line">		p2.setIdCard(ic2);</span><br><span class="line">		Person p3 = <span class="keyword">new</span> Person();</span><br><span class="line">		p3.setPname(<span class="string">"小明3"</span>);</span><br><span class="line">		p3.setPsex(<span class="string">"女"</span>);</span><br><span class="line">		p3.setPage(<span class="number">18</span>);</span><br><span class="line">		p3.setIdCard(ic3);</span><br><span class="line">		List&lt;Person&gt; persons = <span class="keyword">new</span> ArrayList&lt;Person&gt;();</span><br><span class="line">		persons.add(p1);</span><br><span class="line">		persons.add(p2);</span><br><span class="line">		persons.add(p3);</span><br><span class="line">		personRepository.saveAll(persons);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findAllPerson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personRepository.findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findAllIdCard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> idCardRepository.findAll();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据人员ID查询身份信息（级联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">findByPerson_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> idCardRepository.findByPerson_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findByAddressAndCode</span><span class="params">(String address, String code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> idCardRepository.findByAddressAndCode(address, code);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据身份ID查询人员信息（级联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">findByIdCard_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personRepository.findByIdCard_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findByPnameAndPsex</span><span class="params">(String pname, String psex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personRepository.findByPnameAndPsex(pname, psex);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">getOneIdCard</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> idCardRepository.getOne(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">getOnePerson</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personRepository.getOne(id);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-4-4-TestOneToOneController控制层"><a href="#6-4-4-TestOneToOneController控制层" class="headerlink" title="6.4.4 TestOneToOneController控制层"></a>6.4.4 TestOneToOneController控制层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.controller;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.IdCard;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Person;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.service.PersonAndIdCardService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestOneToOneController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span> </span><br><span class="line">	<span class="keyword">private</span> PersonAndIdCardService personAndIdCardService;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/save"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		personAndIdCardService.saveAll();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"人员和身份保存成功！"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findAllPerson"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findAllPerson</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span>  personAndIdCardService.findAllPerson();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findAllIdCard"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt;  <span class="title">findAllIdCard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.findAllIdCard();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据人员ID查询身份信息（级联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByPerson_id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">findByPerson_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.findByPerson_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByAddressAndCode"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;IdCard&gt; <span class="title">findByAddressAndCode</span><span class="params">(String address, String code)</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.findByAddressAndCode(address, code);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据身份ID查询人员信息（级联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByIdCard_id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">findByIdCard_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.findByIdCard_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByPnameAndPsex"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">findByPnameAndPsex</span><span class="params">(String pname, String psex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.findByPnameAndPsex(pname, psex);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/getOneIdCard"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> IdCard <span class="title">getOneIdCard</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.getOneIdCard(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/getOnePerson"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Person <span class="title">getOnePerson</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> personAndIdCardService.getOnePerson(id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-5-OneToMany和-ManyToOne"><a href="#6-5-OneToMany和-ManyToOne" class="headerlink" title="6.5 @OneToMany和@ManyToOne"></a>6.5 @OneToMany和@ManyToOne</h3><p>​    在Spring Data JPA中，使用@OneToMany和@ManyToOne来表示一对多的双向关联。<br>​    例如，一端（Author）使用@OneToMany，多端（Article）使用@ManyToOne。</p>
<p>​    在JPA规范中，一对多的双向关系由多端（如Article）来维护。就是说多端为关系的维护端，负责关系的增删改查。一端则为关系的被维护端，不能维护关系。</p>
<p>​    一端（Author）使用@OneToMany注解的mappedBy=”author”属性表明一端（Author）是关系的被维护端。</p>
<p>​    多端（Article）使用@ManyToOne和@JoinColumn来注解属性author，@ManyToOne表明Article是多端，@JoinColumn设置在article表的关联字段（外键）上。</p>
<p>接下来我们使用Spring Data JPA实现Author与Article的一对多关系映射。</p>
<h4 id="6-5-1-Author和Article实体类"><a href="#6-5-1-Author和Article实体类" class="headerlink" title="6.5.1 Author和Article实体类"></a>6.5.1 Author和Article实体类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.OneToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"author_table"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Author</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="comment">//作者名</span></span><br><span class="line">	<span class="keyword">private</span> String aname;</span><br><span class="line">	<span class="comment">//文章列表，作者与文章是一对多的关系</span></span><br><span class="line">    <span class="meta">@OneToMany</span>(</span><br><span class="line">    		mappedBy = <span class="string">"author"</span>,</span><br><span class="line">    		cascade=CascadeType.ALL,</span><br><span class="line">    		targetEntity = Article<span class="class">.<span class="keyword">class</span>, </span></span><br><span class="line"><span class="class">    		<span class="title">fetch</span></span>=FetchType.LAZY</span><br><span class="line">    		)</span><br><span class="line">    <span class="keyword">private</span> List&lt;Article&gt; articleList;</span><br><span class="line">	<span class="comment">//省略set get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Basic;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.CascadeType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.FetchType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Lob;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"article_table"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Article</span>  <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="comment">//标题</span></span><br><span class="line">    <span class="meta">@Column</span>(nullable = <span class="keyword">false</span>, length = <span class="number">50</span>)</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">	<span class="comment">//文章内容</span></span><br><span class="line">    <span class="meta">@Lob</span>  <span class="comment">//大对象，映射 为MySQL的Long文本类型</span></span><br><span class="line">    <span class="meta">@Basic</span>(fetch = FetchType.LAZY) </span><br><span class="line">    <span class="meta">@Column</span>(nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="comment">//所属作者，文章与作者是多对一的关系</span></span><br><span class="line">    <span class="meta">@ManyToOne</span>(cascade=&#123;CascadeType.MERGE,CascadeType.REFRESH&#125;,optional=<span class="keyword">false</span>)</span><br><span class="line">    <span class="comment">//可选属性optional=false,表示author不能为空。删除文章，不影响用户</span></span><br><span class="line">    <span class="meta">@JoinColumn</span>(name=<span class="string">"id_author_id"</span>)<span class="comment">//设置在article表中的关联字段(外键)</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> Author author;</span><br><span class="line">	 <span class="comment">//省略set get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-5-2-ArticleRepository和AuthorRepository数据访问层"><a href="#6-5-2-ArticleRepository和AuthorRepository数据访问层" class="headerlink" title="6.5.2 ArticleRepository和AuthorRepository数据访问层"></a>6.5.2 ArticleRepository和AuthorRepository数据访问层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Article;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ArticleRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Article</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据作者id查询文章信息（关联查询，根据author属性的id）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select a from Article a where a.author.id = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据作者名查询文章信息（关联查询，根据author属性的aname）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select a from Article a where a.author.aname = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_aname</span><span class="params">(String aname)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Author;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.Query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AuthorRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Author</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据文章标题包含的内容，查询作者（关联查询）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select a from Author a  inner join  a.articleList t where t.title like %?1%</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findByArticleList_titleContaining</span><span class="params">(String title)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据文章标题包含的内容，查询作者（关联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"select a from Author a  inner join  a.articleList t where t.title like %?1%"</span> )</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findAuthorByArticleListtitleContaining</span><span class="params">(String title)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-5-3-AuthorAndArticleService和AuthorAndArticleServiceImpl服务层"><a href="#6-5-3-AuthorAndArticleService和AuthorAndArticleServiceImpl服务层" class="headerlink" title="6.5.3 AuthorAndArticleService和AuthorAndArticleServiceImpl服务层"></a>6.5.3 AuthorAndArticleService和AuthorAndArticleServiceImpl服务层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Article;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Author;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AuthorAndArticleService</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_id</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_aname</span><span class="params">(String aname)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findByArticleList_titleContaining</span><span class="params">(String title)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findAuthorByArticleListtitleContaining</span><span class="params">(String title)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Article;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Author;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.ArticleRepository;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.AuthorRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthorAndArticleServiceImpl</span> <span class="keyword">implements</span> <span class="title">AuthorAndArticleService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AuthorRepository authorRepository;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> ArticleRepository articleRepository;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//保存作者（先保存一的一端）</span></span><br><span class="line">		Author a1 = <span class="keyword">new</span> Author();</span><br><span class="line">		a1.setAname(<span class="string">"小明1"</span>);</span><br><span class="line">		Author a2 = <span class="keyword">new</span> Author();</span><br><span class="line">		a2.setAname(<span class="string">"小明2"</span>);</span><br><span class="line">		ArrayList&lt;Author&gt; allAuthor = <span class="keyword">new</span> ArrayList&lt;Author&gt;();</span><br><span class="line">		allAuthor.add(a1);</span><br><span class="line">		allAuthor.add(a2);</span><br><span class="line">		authorRepository.saveAll(allAuthor);</span><br><span class="line">		<span class="comment">//保存文章</span></span><br><span class="line">		Article at1 = <span class="keyword">new</span> Article();</span><br><span class="line">		at1.setTitle(<span class="string">"JPA的一对多111"</span>);</span><br><span class="line">		at1.setContent(<span class="string">"其实一对多映射关系很常见111。"</span>);</span><br><span class="line">		<span class="comment">//设置关系</span></span><br><span class="line">		at1.setAuthor(a1);</span><br><span class="line">		Article at2 = <span class="keyword">new</span> Article();</span><br><span class="line">		at2.setTitle(<span class="string">"JPA的一对多222"</span>);</span><br><span class="line">		at2.setContent(<span class="string">"其实一对多映射关系很常见222。"</span>);</span><br><span class="line">		<span class="comment">//设置关系</span></span><br><span class="line">		at2.setAuthor(a1);<span class="comment">//文章2与文章1作者相同</span></span><br><span class="line">		Article at3 = <span class="keyword">new</span> Article();</span><br><span class="line">		at3.setTitle(<span class="string">"JPA的一对多333"</span>);</span><br><span class="line">		at3.setContent(<span class="string">"其实一对多映射关系很常见333。"</span>);</span><br><span class="line">		<span class="comment">//设置关系</span></span><br><span class="line">		at3.setAuthor(a2);</span><br><span class="line">		Article at4 = <span class="keyword">new</span> Article();</span><br><span class="line">		at4.setTitle(<span class="string">"JPA的一对多444"</span>);</span><br><span class="line">		at4.setContent(<span class="string">"其实一对多映射关系很常见444。"</span>);</span><br><span class="line">		<span class="comment">//设置关系</span></span><br><span class="line">		at4.setAuthor(a2);<span class="comment">//文章3与文章4作者相同</span></span><br><span class="line">		ArrayList&lt;Article&gt; allAt = <span class="keyword">new</span> ArrayList&lt;Article&gt;();</span><br><span class="line">		allAt.add(at1);</span><br><span class="line">		allAt.add(at2);</span><br><span class="line">		allAt.add(at3);</span><br><span class="line">		allAt.add(at4);</span><br><span class="line">		articleRepository.saveAll(allAt);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> articleRepository.findByAuthor_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_aname</span><span class="params">(String aname)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> articleRepository.findByAuthor_aname(aname);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findByArticleList_titleContaining</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorRepository.findByArticleList_titleContaining(title);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findAuthorByArticleListtitleContaining</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorRepository.findAuthorByArticleListtitleContaining(title);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-5-4-TestOneToManyController控制层"><a href="#6-5-4-TestOneToManyController控制层" class="headerlink" title="6.5.4 TestOneToManyController控制层"></a>6.5.4 TestOneToManyController控制层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.controller;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Article;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Author;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.service.AuthorAndArticleService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestOneToManyController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span> </span><br><span class="line">	<span class="keyword">private</span> AuthorAndArticleService authorAndArticleService;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/saveOneToMany"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		authorAndArticleService.saveAll();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"作者和文章保存成功！"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findArticleByAuthor_id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_id</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorAndArticleService.findByAuthor_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findArticleByAuthor_aname"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Article&gt; <span class="title">findByAuthor_aname</span><span class="params">(String aname)</span></span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorAndArticleService.findByAuthor_aname(aname);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByArticleList_titleContaining"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findByArticleList_titleContaining</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorAndArticleService.findByArticleList_titleContaining(title);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findAuthorByArticleListtitleContaining"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Author <span class="title">findAuthorByArticleListtitleContaining</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorAndArticleService.findAuthorByArticleListtitleContaining(title);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-6-ManyToMany"><a href="#6-6-ManyToMany" class="headerlink" title="6.6 @ManyToMany"></a>6.6 @ManyToMany</h3><p>​    在Spring Data JPA中使用@ManyToMany来注解多对多的映射关系，由一个关联表来维护。<br>​    关联表的表名默认是：主表名+下划线+从表名（主表是指关系维护端对应的表，从表是指关系被维护端对应的表）。<br>​    关联表只有两个外键字段，分别指向主表ID和从表ID。<br>​    字段的名称默认为：主表名+下划线+主表中的主键列名，从表名+下划线+从表中的主键列名。<br>​    需要注意的是，多对多关系中一般不设置级联保存、级联删除、级联更新等操作。</p>
<p><img src= "/img/loading.gif" data-src="https://image.bithachi.cn/20201229125642.png" alt="image-20201229125642691"></p>
<h4 id="6-6-1-Authority和User实体类"><a href="#6-6-1-Authority和User实体类" class="headerlink" title="6.6.1 Authority和User实体类"></a>6.6.1 Authority和User实体类</h4><p>使用Spring Data JPA实现用户（User）与权限（Authority）的多对多关系映射。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnore;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"authority"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Authority</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="meta">@Column</span>(nullable = <span class="keyword">false</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@ManyToMany</span>(mappedBy = <span class="string">"authorityList"</span>)</span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; userList;</span><br><span class="line">	<span class="comment">//省略set get</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.entity;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GenerationType;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinTable;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToMany;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnoreProperties;</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@Table</span>(name = <span class="string">"user"</span>)</span><br><span class="line"><span class="meta">@JsonIgnoreProperties</span>(value = &#123; <span class="string">"hibernateLazyInitializer"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">  	<span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password; </span><br><span class="line">    <span class="meta">@ManyToMany</span></span><br><span class="line">    <span class="meta">@JoinTable</span>(name = <span class="string">"user_authority"</span>,joinColumns = <span class="meta">@JoinColumn</span>(name = <span class="string">"user_id"</span>),</span><br><span class="line">    inverseJoinColumns = <span class="meta">@JoinColumn</span>(name = <span class="string">"authority_id"</span>))</span><br><span class="line">    <span class="comment">/**1、关系维护端，负责多对多关系的绑定和解除</span></span><br><span class="line"><span class="comment">    2、<span class="doctag">@JoinTable</span>注解的name属性指定关联表的名字，joinColumns指定外键的名字，关联到关系维护端（User）</span></span><br><span class="line"><span class="comment">    3、inverseJoinColumns指定外键的名字，要关联的关系被维护端（Authority）</span></span><br><span class="line"><span class="comment">    4、其实可以不使用<span class="doctag">@JoinTable</span>注解，默认生成的关联表名称为主表表名+下划线+从表表名，</span></span><br><span class="line"><span class="comment">        即表名为user_authority</span></span><br><span class="line"><span class="comment">        关联到主表的外键名：主表名+下划线+主表中的主键列名,即user_id</span></span><br><span class="line"><span class="comment">        关联到从表的外键名：主表中用于关联的属性名+下划线+从表的主键列名,即authority_id</span></span><br><span class="line"><span class="comment">        主表就是关系维护端对应的表，从表就是关系被维护端对应的表</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Authority&gt; authorityList;</span><br><span class="line">	<span class="comment">//省略 get set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-6-2-UserRepository和AuthorityRepository数据访问层"><a href="#6-6-2-UserRepository和AuthorityRepository数据访问层" class="headerlink" title="6.6.2 UserRepository和AuthorityRepository数据访问层"></a>6.6.2 UserRepository和AuthorityRepository数据访问层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Authority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.Query;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AuthorityRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">Authority</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据用户id查询用户所拥有的权限（关联查询）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select a from Authority a inner join a.userList u where u.id = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_id</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据用户名查询用户所拥有的权限（关联查询）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select a from Authority a inner join a.userList u where u.username = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_Username</span><span class="params">(String username)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据用户名查询用户所拥有的权限（关联查询）</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"select a from Authority a inner join a.userList u where u.username = ?1"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserListUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.repository;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserRepository</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据权限id查询拥有该权限的用户（关联查询）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select u from User u inner join u.authorityList a where a.id = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_id</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 根据权限名查询拥有该权限的用户（关联查询）</span></span><br><span class="line"><span class="comment">	 * 相当于JPQL语句：select u from User u inner join u.authorityList a where a.name = ?1</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_name</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-6-3-UserAndAuthorityService和UserAndAuthorityServiceImpl服务层"><a href="#6-6-3-UserAndAuthorityService和UserAndAuthorityServiceImpl服务层" class="headerlink" title="6.6.3 UserAndAuthorityService和UserAndAuthorityServiceImpl服务层"></a>6.6.3 UserAndAuthorityService和UserAndAuthorityServiceImpl服务层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Authority;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserAndAuthorityService</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_id</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_name</span><span class="params">(String name)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_id</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_Username</span><span class="params">(String username)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserListUsername</span><span class="params">(String username)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.service;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Authority;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.User;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.AuthorityRepository;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.repository.UserRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAndAuthorityServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserAndAuthorityService</span></span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AuthorityRepository authorityRepository;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserRepository userRepository;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">//添加权限1</span></span><br><span class="line">		Authority at1 = <span class="keyword">new</span> Authority();</span><br><span class="line">		at1.setName(<span class="string">"增加"</span>);</span><br><span class="line">		authorityRepository.save(at1);</span><br><span class="line">		<span class="comment">//添加权限2</span></span><br><span class="line">		Authority at2 = <span class="keyword">new</span> Authority();</span><br><span class="line">		at2.setName(<span class="string">"修改"</span>);</span><br><span class="line">		authorityRepository.save(at2);</span><br><span class="line">		<span class="comment">//添加权限3</span></span><br><span class="line">		Authority at3 = <span class="keyword">new</span> Authority();</span><br><span class="line">		at3.setName(<span class="string">"删除"</span>);</span><br><span class="line">		authorityRepository.save(at3);</span><br><span class="line">		<span class="comment">//添加权限4</span></span><br><span class="line">		Authority at4 = <span class="keyword">new</span> Authority();</span><br><span class="line">		at4.setName(<span class="string">"查询"</span>);</span><br><span class="line">		authorityRepository.save(at4);</span><br><span class="line">		<span class="comment">//添加用户1</span></span><br><span class="line">		User u1 = <span class="keyword">new</span> User();</span><br><span class="line">		u1.setUsername(<span class="string">"小明1"</span>);</span><br><span class="line">		u1.setPassword(<span class="string">"123"</span>);</span><br><span class="line">		ArrayList&lt;Authority&gt; authorityList1 = <span class="keyword">new</span> ArrayList&lt;Authority&gt;();</span><br><span class="line">		authorityList1.add(at1);</span><br><span class="line">		authorityList1.add(at2);</span><br><span class="line">		authorityList1.add(at3);</span><br><span class="line">		u1.setAuthorityList(authorityList1);</span><br><span class="line">		userRepository.save(u1);</span><br><span class="line">		<span class="comment">//添加用户2</span></span><br><span class="line">		User u2 = <span class="keyword">new</span> User();</span><br><span class="line">		u2.setUsername(<span class="string">"小明2"</span>);</span><br><span class="line">		u2.setPassword(<span class="string">"234"</span>);</span><br><span class="line">		ArrayList&lt;Authority&gt; authorityList2 = <span class="keyword">new</span> ArrayList&lt;Authority&gt;();</span><br><span class="line">		authorityList2.add(at2);</span><br><span class="line">		authorityList2.add(at3);</span><br><span class="line">		authorityList2.add(at4);</span><br><span class="line">		u2.setAuthorityList(authorityList2);</span><br><span class="line">		userRepository.save(u2);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_id</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userRepository.findByAuthorityList_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_name</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userRepository.findByAuthorityList_name(name);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_id</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorityRepository.findByUserList_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_Username</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorityRepository.findByUserList_Username(username);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserListUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> authorityRepository.findByUserListUsername(username);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-6-4-TestManyToManyController控制层"><a href="#6-6-4-TestManyToManyController控制层" class="headerlink" title="6.6.4 TestManyToManyController控制层"></a>6.6.4 TestManyToManyController控制层</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.bithachi.jpa.controller;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.Authority;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.entity.User;</span><br><span class="line"><span class="keyword">import</span> cn.bithachi.jpa.service.UserAndAuthorityService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestManyToManyController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span> </span><br><span class="line">	<span class="keyword">private</span> UserAndAuthorityService userAndAuthorityService;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/saveManyToMany"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		userAndAuthorityService.saveAll();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"权限和用户保存成功！"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByAuthorityList_id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_id</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userAndAuthorityService.findByAuthorityList_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByAuthorityList_name"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">findByAuthorityList_name</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userAndAuthorityService.findByAuthorityList_name(name);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByUserList_id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_id</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userAndAuthorityService.findByUserList_id(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByUserList_Username"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserList_Username</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userAndAuthorityService.findByUserList_Username(username);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/findByUserListUsername"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;Authority&gt; <span class="title">findByUserListUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> userAndAuthorityService.findByUserListUsername(username);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">BitHachi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.bithachi.cn/posts/dd692fd4.html">https://www.bithachi.cn/posts/dd692fd4.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.bithachi.cn" target="_blank">BitHachi</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SpringBoot/">SpringBoot</a><a class="post-meta__tags" href="/tags/Spring-Data-JPA/">Spring Data JPA</a></div><div class="post_share"></div></div><div class="post-reward"><button class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="post-qr-code__img" src="/img/wechat.png" alt="微信" onclick="window.open('/img/wechat.png')"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="post-qr-code__img" src="/img/alipay.png" alt="支付宝" onclick="window.open('/img/alipay.png')"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></button></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/a5513b53.html"><img class="prev-cover" data-src="https://cdn.pixabay.com/photo/2020/07/09/17/39/puppy-5388151__340.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">SpringBoot：(异步,定时,邮件)任务</div></div></a></div><div class="next-post pull-right"><a href="/posts/b5592004.html"><img class="next-cover" data-src="https://cdn.pixabay.com/photo/2017/02/20/18/03/cat-2083492__340.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">SpringBoot整合(JDBC,Druid,Mybatis)+JDBCTemplate案例</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/fb65d1e8.html" title="初探SpringBoot自动装配原理"><img class="relatedPosts_cover" data-src="https://i0.hippopx.com/photos/21/502/433/atmosphere-earth-nature-blue-preview.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-26 14:52:16</div><div class="relatedPosts_title">初探SpringBoot自动装配原理</div></div></a></div><div class="relatedPosts_item"><a href="/posts/48bc7774.html" title="SpringBoot中使用JSR303校验"><img class="relatedPosts_cover" data-src="https://cdn.pixabay.com/photo/2016/06/14/09/58/cat-1456173__340.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-26 20:51:01</div><div class="relatedPosts_title">SpringBoot中使用JSR303校验</div></div></a></div><div class="relatedPosts_item"><a href="/posts/37a6356d.html" title="SpringBoot配置文件的编写和读取+配置文件的加载位置与多环境切换"><img class="relatedPosts_cover" data-src="https://images.pexels.com/photos/2072599/pexels-photo-2072599.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-26 17:03:17</div><div class="relatedPosts_title">SpringBoot配置文件的编写和读取+配置文件的加载位置与多环境切换</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var requestSetting = function (from,set) {
  var from = from
  var setting = set.split(',').filter(function(item){
  return from.indexOf(item) > -1
  });
  setting = setting.length == 0 ? from :setting;
  return setting
}

var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
var requiredFields = requestSetting(['nick','mail'],'nick,mail')

window.valine = new Valine({
  el:'#vcomment',
  appId: 'NRvlHdgJSxUn4u8Q1sgVDnlP-gzGzoHsz',
  appKey: '5sa3oi8Nwmzfo8zdXrnvibI0',
  placeholder: '记得留下你的昵称和邮箱....可以快速收到回复',
  avatar: 'monsterid',
  meta: guestInfo,
  pageSize: '10',
  lang: 'zh-CN',
  recordIP: false,
  serverURLs: '',
  emojiCDN: '',
  emojiMaps: "",
  enableQQ: false,
  requiredFields: requiredFields
});</script></div></article></main><footer id="footer" style="background-image: url(https://cdn.pixabay.com/photo/2016/11/18/13/13/animal-1834401__340.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By BitHachi</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my blog.</div><div class="icp"><a href="https://beian.miit.gov.cn" target="_blank" rel="noopener"><img class="icp-icon" src="/img/icp.png"/><span>鄂ICP备20002680号-1</span></a></div></div><div class="container" id="jsi-flying-fish-container"></div><script src="js/fish.js"></script><style>@media only screen and (max-width: 767px){
#sidebar_search_box input[type=text]{width:calc(100%)}
}</style></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" title="缩小字体"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="简繁转换">简</button><button id="darkmode" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fas fa-comments"></i></a><button class="close" id="mobile-toc-button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/third-party/click_heart.js"></script><script src="https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
  pangu.autoSpacingPage()
})</script><script src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/gh/xiabo2/CDN@latest/fish.js"></script></body></html>